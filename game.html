<html>
  <head>
    <meta charset="utf-8" />
    <title>Facing Worlds</title>
    <!-- Prevent favicon 404 error -->
    <link
      rel="icon"
      href="data:," />
    <meta
      name="description"
      content="" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1" />

    <!-- Load A-Frame and Extras from local files -->
    <script src="./assets/libraries/aframe/aframe.min.js"></script>
    <script src="./assets/libraries/aframe-extras.min.js"></script>

    <!-- Load main game script as module -->
    <script
      src="./src/game/core/main.js"
      type="module"
      defer></script>
  </head>
  <body>
    <a-scene
      gltf-viewer-settings
      console-suppression
      inspector="enabled: true"
      loading-screen="enabled: false"
      xr-mode-ui="enabled: false"
      renderer="colorManagement: true; physicallyCorrectLights: true;toneMapping: ACESFilmicToneMapping; toneMappingExposure: 1.2">
      <!-- Space Environment -->
      <a-entity
        space-environment="enabled:true; starCount:0; asteroidCount:0; asteroidSpeed:0.5; nebulaEnabled:false; backgroundColor:#000000"></a-entity>

      <!-- Background Music -->
      <a-entity background-music="enabled:true; volume:0.8; loop:true; autoplay:false; startOnFirstBullet:true"></a-entity>
      <a-assets>
        <a-asset-item
          id="world-gltf"
          src="assets/3d/map/FacingWorlds_tex_5.gltf"></a-asset-item>
        <a-asset-item
          id="navmesh-gltf"
          src="assets/3d/navmesh.gltf"></a-asset-item>

        <!-- Weapon Assets -->
        <a-asset-item
          id="enforcer-weapon"
          src="assets/3d/enforcer.glb"></a-asset-item>

        <!-- Audio Assets -->
        <audio
          id="background-music"
          src="assets/audio/110-van_den_bos--foregone_destruction-i.mp3"
          preload="auto"></audio>
        <audio
          id="fire-sound"
          src="assets/audio/fire.wav"
          preload="auto"></audio>
      </a-assets>

      <!-- fixed camera (no look-controls) -->

      <!-- Warm Ambient Light -->
      <a-entity
        light="type:hemisphere; intensity:1.8; color:#e4d4b9; groundColor:#7c5c46; decay:6.82"
        position="0 10 0"></a-entity>

      <!-- Blue Point Lights (Left Side) -->
      <a-entity
        light="type:point; intensity:15; color:#4A90E2; castShadow:true; distance:5; decay:1.5"
        position="-24.3 14.6 -4"></a-entity>
      <a-entity
        light="type:point; intensity:15; color:#4A90E2; castShadow:true; distance:5; decay:1.5"
        position="-24.3 14.6 4"></a-entity>
      <a-entity
        light="type:point; intensity:15; color:#0008ff; castShadow:true; distance:5; decay:1.5"
        position="-32.3 32.9 -2.57"></a-entity>
      <a-entity
        light="type:point; intensity:15; color:#0008ff; castShadow:true; distance:5; decay:1.5"
        position="-32.3 32.9 2.05"></a-entity>

      <!-- Red Point Lights (Right Side) -->
      <a-entity
        light="type:point; intensity:15; color:#E24A4A; castShadow:true; distance:5; decay:1.5"
        position="34.4 10.7 -10.4"></a-entity>
      <a-entity
        light="type:point; intensity:15; color:#E24A4A; castShadow:true; distance:5; decay:1.5"
        position="34.4 10.7 -0.6"></a-entity>
      <a-entity
        light="type:point; intensity:15; color:#E24A4A; castShadow:true; distance:5; decay:1.5"
        position="41.6 32.6 -7.30393"></a-entity>
      <a-entity
        light="type:point; intensity:15; color:#E24A4A; castShadow:true; distance:5; decay:1.5"
        position="41.6 32.6 -2.85067"></a-entity>

      <!-- World + NavMesh -->
      <a-entity
        id="world"
        gltf-model="#world-gltf"
        gltf-animation-pointer="enabled:true; autoPlay:true; speed:1.0"
        -advanced-material-animation="enabled:true; animationType:opacity; speed:1.0; intensity:1.0; minValue:0.5; maxValue:0.5; emissiveGlow:false"
        pixelated-texture
        position="0 0 0"
        rotation="0 0 0"
        scale="1 1 1"></a-entity>
      <a-entity
        id="navmesh"
        gltf-model="#navmesh-gltf"
        nav-mesh
        visible="false"
        position="0 0 0"
        rotation="0 0 0"
        scale="1 1 1"></a-entity>

      <!-- soldier -->

      <!-- Player rig (built-in movement-controls) -->
      <!-- Player Rig (moves and rotates) -->
      <a-entity
        id="rig"
        movement-controls="constrainToNavMesh: true; speed: 0.4; fly: false"
        rotate-yaw
        position="0 0 0">
        <!-- Soldier Body (follows rig movement, fixed rotation) -->
        <a-entity
          id="soldier"
          gltf-model="https://threejs.org/examples/models/gltf/Soldier.glb"
          character="idleIdx:0; walkIdx:3; runIdx:1"
          health="max:100; current:100"
          invisible-to-player="enabled: true"
          local-player="true"
          position="0 0 0"
          rotation="0 0 0">
        </a-entity>

        <!-- Camera (child of rig, follows movement and rotation) -->
        <a-entity
          id="cam"
          camera="active: true"
          look-controls="enabled: true"
          position="0 1.4 0"
          first-person-weapon="enabled: true; muzzleOffset: 0.8 0.1 0">
          <!-- Weapon (child of camera, follows look direction) -->
          <a-entity
            id="player-weapon"
            gltf-model="assets/3d/enforcer.glb"
            scale="0.025 0.025 0.025"
            position="0.3 -0.2 -0.5">
            <!-- Muzzle point (position this at the tip of the weapon barrel) -->
            <a-entity
              id="weapon-muzzle"
              position="0 0 -15.6895"
              geometry="primitive: sphere; radius: 0.01"
              material="opacity: 0.8; transparent: true; color: red"
              visible="false">
            </a-entity>
          </a-entity>
        </a-entity>
      </a-entity>

      <!-- Fixed Security Camera (Rotates to Track Player) -->
      <a-entity
        id="fixedcam"
        camera="active: false"
        position="0 40 0"
        rotation="-90 0 0"
        camera-tracker="target: #soldier; enabled: true">
      </a-entity>

      <!-- Highscore Display -->
      <a-entity highscore-display="enabled: true; maxPlayers: 10; updateInterval: 1000"></a-entity>

      <!-- Credits Display -->
      <a-entity credits-display="enabled: true; fadeInDelay: 2000; fadeInDuration: 1000"></a-entity>

      <!-- Name Changer
      <a-entity name-changer="enabled: true; key: KeyN"></a-entity> -->
    </a-scene>
  </body>
</html>
