<html>
  <head>
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.0/dist/aframe-extras.min.js"></script>
  </head>
  <body>
    <a-scene background="color:black">
      <a-assets>
        <a-asset-item
          id="world-gltf"
          src="src/3d/map_pbr.gltf"></a-asset-item>
        <a-asset-item
          id="navmesh-gltf"
          src="src/3d/map_navmesh.gltf"></a-asset-item>
      </a-assets>

      <!-- fixed camera (no look-controls) -->

      <!-- lights -->
      <a-entity
        light="type:hemisphere; intensity:1.5; color:#fff; groundColor:#888"
        position="0 10 0"></a-entity>
      <a-entity
        light="type:directional; intensity:3; castShadow:true"
        position="-2 5 -3"></a-entity>

      <!-- World + NavMesh -->
      <a-entity
        id="world"
        gltf-model="#world-gltf"
        gltf-animation-pointer="enabled:true; autoPlay:true; speed:1.0"
        advanced-material-animation="enabled:true; animationType:opacity; speed:1.0; intensity:1.0; minValue:0.3; maxValue:1.0; emissiveGlow:true"
        position="0 0 0"
        rotation="0 0 0"
        scale="1 1 1"></a-entity>
      <a-entity
        id="navmesh"
        gltf-model="#navmesh-gltf"
        nav-mesh
        debug-material
        visible="true"
        position="0 0 0"
        rotation="0 0 0"
        scale="1 1 1"></a-entity>

      <!-- soldier -->

      <!-- Player rig (built-in movement-controls) -->
      <a-entity
        id="rig"
        movement-controls="constrainToNavMesh: true; speed: 0.4"
        navmesh-constraint="navmesh: #navmesh; fall: 8; height: 0.12"
        rotate-yaw
        position="0 0 0">
        <a-entity
          id="soldier"
          gltf-model="https://threejs.org/examples/models/gltf/Soldier.glb"
          blaster="bulletSpeed:18; fireRate:8; bulletRadius:0.08; color:#ffcc00; spawnLocal:true"
          character="idleIdx:0; walkIdx:3; runIdx:1"
          health="max:100; current:100">
        </a-entity>

        <!-- 1st Person Camera -->
        <a-entity
          id="cam"
          camera="active: true"
          look-controls="pointerLockEnabled: true"
          position="0 1.8 0">
        </a-entity>
      </a-entity>

      <!-- 3rd Person Camera (orbit around rig) -->
      <a-entity
        id="mapcam"
        camera="active: false"
        orbit-camera="target: #rig; radius: 6; minRadius: 3; maxRadius: 15; polar: 15; azimuth: 0; rotateSpeed: 0.25; zoomSpeed: 1; height: 1.5">
      </a-entity>

      <!-- Fixed Overhead Camera -->
      <a-entity
        id="fixedcam"
        camera="active: false"
        position="0 40 0"
        rotation="-90 0 0">
      </a-entity>

      <!-- Animated Curtain -->
      <a-entity
        animated-curtain="width:12; height:8; windStrength:1.5; windSpeed:1.2; color:#8B4513; texture:fabric; opacity:0.8; position:8 4 0; rotation:0 90 0">
      </a-entity>

      <!-- Camera Controls (press C to cycle) -->
      <a-entity camera-controls="cycleKey: KeyC"></a-entity>

      <!-- GUI Controls -->
      <a-entity gui-controls="enabled:true; position:10 10 0"></a-entity>
    </a-scene>
    <script
      type="module"
      src="./src/core/main.js"></script>
  </body>
</html>
